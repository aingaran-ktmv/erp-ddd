# Project Genesis: A Guide for the AI Assistant (GitHub Copilot)

Hello Copilot,

Welcome to the Principal Desk ERP project. You are my primary assistant in building this large-scale, domain-driven application. Your purpose is to accelerate development by generating high-quality, conventional code that strictly adheres to our defined architecture.

This document is your source of truth. Refer to these principles in all your suggestions.

---

## The Grand Plan & Our Strategy

Our mission is to build a scalable system that can grow to 25+ domains. We will achieve this by building the foundational domains first, ensuring a stable base for more complex features later.

This is our strategic implementation order. Understand these dependencies:

1. **Master Domain (The Foundation)**: Build first. Contains shared, core entities like Users, Staff, Students, Subjects, Classes, etc. All other domains depend on this.
2. **School Domain (The Context)**: Defines the organization itself.
3. **Administration Domain (The Operations)**: Creates the relationships and schedules (Timetables, Duties). It consumes the Master domain.
4. **Curriculum Domain (The Transactions)**: Tracks the daily execution of the plan. It consumes the Administration domain.
5. **Plan & Reporting Domains (The Analysis)**: Built last to analyze the data generated by the other domains.

---

## The Three Unbreakable Rules of Our Architecture

Your suggestions MUST ALWAYS follow these architectural rules. This is your most important directive.

### Rule #1: The "Filament-First" Standard Location.

The locations for UI and data entities are FIXED and NON-NEGOTIABLE.

-   All Eloquent Models MUST go in `app/Models/`.
-   All Database Migrations MUST go in `database/migrations/`.
-   All Filament Resources and their Pages MUST go in `app/Filament/Resources/`.

NEVER suggest placing these files inside `app/Domains/`.

### Rule #2: The `app/Domains` Folder is for Pure Logic ONLY.

This folder is the "brain" of our application, not its skeleton.

The `app/Domains/{DomainName}/` folder is EXCLUSIVELY for code that is NOT a Model, Migration, or Filament Resource.

This is the home for **Services** (e.g., `TimetableService`), **Policies** (e.g., `SchoolPolicy`), **ValueObjects**, and other pure PHP classes that contain business rules and orchestrate complex tasks.

### Rule #3: The `docs/` Directory is My Voice.

The specifications for every piece of code we build are located in the `docs/` folder, especially the `domain_*.implementation.md` files.

When I paste a comment block from one of those files into a new Model or Migration, that is your PRIMARY PROMPT.

Generate the code that precisely matches the schema or configuration described in that comment. Treat it as a direct order.

---

## Our Workflow in Action (An Example)

When we build the Timetable feature for the Administration domain, this is how we will do it:

1. **Migration:** Run `php artisan make:migration create_timetables_table`.
    - Open the new file in `database/migrations/` and paste the schema comment from the docs.
    - Your job is to generate the schema code.
2. **Model:** Run `php artisan make:model Timetable`.
    - Open `app/Models/Timetable.php` and paste the model configuration comment.
    - Your job is to generate the fillable array, casts, and relationships.
3. **Filament Resource:** Run `php artisan make:filament-resource TimetableResource`.
    - Open `app/Filament/Resources/TimetableResource.php` and paste comments to define the form and table.
    - Your job is to generate the Filament forms and tables.
4. **Service (if needed):** Manually create `app/Domains/Administration/Services/TimetableService.php`.
    - Your job is to help write the methods inside this service class.

Adhere to these directives, and we will build a clean, scalable, and maintainable application together.

---

## Quick Checklist for Contributions

-   [ ] Does the change keep models in `app/Models` and migrations in `database/migrations`?
-   [ ] Are Filament Resources under `app/Filament/Resources`?
-   [ ] Is domain logic (services/policies/value objects) inside `app/Domains/{Domain}`?
-   [ ] Does the schema avoid native `YEAR`, prefer strings over `ENUM`, and include soft deletes via `deleted_at`?
-   [ ] Are polymorphic relations indexed on `(type, id)`?

If any answer is "no", fix it before proceeding.
